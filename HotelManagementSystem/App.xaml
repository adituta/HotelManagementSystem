<Application x:Class="HotelManagementSystem.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:HotelManagementSystem"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             StartupUri="MainWindow.xaml">
    <Application.Resources>

        <!--traduce din true/ false in Visible/Collapsed -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />

        <!-- Stilul pentru butoanele din meniul lateral al Administratorului -->
        <Style x:Key="SidebarButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="45"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="20,0,0,0"/>
            <Setter Property="Margin" Value="0,2"/>

            <Style.Triggers>
                <!-- Efect de hover (când treci cu mouse-ul peste buton) -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#34495E"/>
                    <Setter Property="Cursor" Value="Hand"/>
                </Trigger>

                <!-- Efect când butonul este apăsat -->
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#1ABC9C"/>
                </Trigger>
            </Style.Triggers>
        </Style>

            <!-- Stil Calendar (DatePicker) Global -->
            <Style TargetType="{x:Type DatePickerTextBox}">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type DatePickerTextBox}">
                            <Border BorderThickness="0" Background="Transparent" Padding="2">
                                <ScrollViewer x:Name="PART_ContentHost" Margin="0" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="{x:Type DatePicker}">
                
                <Style.Resources>
                    <Style TargetType="DatePickerTextBox">
                        <Setter Property="IsReadOnly" Value="True"/>
                        <Setter Property="Cursor" Value="Arrow"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DatePickerTextBox">
                                     <Grid>
                                        <Border BorderThickness="0" Background="Transparent">
                                            <TextBox Text="{Binding Path=SelectedDate, StringFormat='dd.MM.yyyy', RelativeSource={RelativeSource AncestorType={x:Type DatePicker}}}" 
                                                     IsReadOnly="True" 
                                                     BorderThickness="0" 
                                                     Background="Transparent" 
                                                     VerticalAlignment="Center" 
                                                     Padding="5,0,0,0"
                                                     Foreground="#2C3E50"
                                                     FontWeight="SemiBold"/>
                                        </Border>
                                     </Grid>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Style.Resources>

                <!-- Culori și Aspect General -->
                <Setter Property="Foreground" Value="#2C3E50"/>
                <Setter Property="IsTodayHighlighted" Value="True"/>
                <Setter Property="SelectedDateFormat" Value="Short"/>
                <Setter Property="Padding" Value="5"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="BorderBrush" Value="#BDC3C7"/>
                <Setter Property="Background" Value="White"/>
                
                <!-- Force Calendar Only (Disable manual typing which bypasses constraints easily) -->
                <Setter Property="Focusable" Value="False"/>
                
                <!-- GLOBAL CONSTRAINT: Do not allow past dates by default -->
                <Setter Property="DisplayDateStart" Value="{x:Static sys:DateTime.Today}"/>

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type DatePicker}">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="5">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="30"/>
                                    </Grid.ColumnDefinitions>

                                    <DatePickerTextBox x:Name="PART_TextBox" 
                                                       Grid.Column="0" 
                                                       Foreground="{TemplateBinding Foreground}" 
                                                       Focusable="False" 
                                                       VerticalContentAlignment="Center"/>

                                    <Button x:Name="PART_Button" 
                                            Grid.Column="1" 
                                            Foreground="#34495E"
                                            Background="Transparent" 
                                            BorderThickness="0" 
                                            Cursor="Hand"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Center"
                                            Focusable="False">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Grid Background="Transparent">
                                                     <Path Data="M19,4H18V2H16V4H8V2H6V4H5A2,2 0 0,0 3,6V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4M19,20H5V10H19V20M19,8H5V6H19V8Z" 
                                                           Fill="{TemplateBinding Foreground}" 
                                                           Stretch="Uniform" 
                                                           Width="16" Height="16"/>
                                                </Grid>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>

                                    <Popup x:Name="PART_Popup" 
                                           AllowsTransparency="True" 
                                           Placement="Bottom"
                                           PlacementTarget="{Binding ElementName=PART_TextBox}" 
                                           StaysOpen="False">
                                           <Border Background="White" BorderThickness="1" BorderBrush="#27AE60" CornerRadius="5" Padding="5">
                                               <Border.Effect>
                                                   <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1" Color="Black"/>
                                               </Border.Effect>
                                               <!-- CRITICAL: The Calendar must be named PART_Calendar for the internal code to attach logic 
                                                    Note: We don't need 'Style="{TemplateBinding CalendarStyle}"' here if we rely on global style, 
                                                    but explicit binding is safer if provided. -->
                                               <Calendar x:Name="PART_Calendar" Style="{TemplateBinding CalendarStyle}"/>
                                           </Border>
                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PART_Popup" Property="IsOpen" Value="True"/>
                                    <!-- Culoarea marginilor calendarului -->
                                    <Setter TargetName="PART_Button" Property="Foreground" Value="#27AE60"/> 
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                
                <!-- Stil Calendar Dropdown -->
                <Setter Property="CalendarStyle">
                    <Setter.Value>
                        <Style TargetType="Calendar">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Calendar">
                                        <Border Background="White" BorderBrush="#27AE60" BorderThickness="1" CornerRadius="5" Padding="5">
                                            <Border.Effect>
                                                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1" Color="Black"/>
                                            </Border.Effect>
                                            <StackPanel x:Name="PART_Root" HorizontalAlignment="Center">
                                                <CalendarItem x:Name="PART_CalendarItem"
                                                              Style="{TemplateBinding CalendarItemStyle}" />
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Setter.Value>
                </Setter>
            </Style>

    </Application.Resources>
</Application>
